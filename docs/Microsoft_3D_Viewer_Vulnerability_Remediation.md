# **Microsoft 3D Viewer Base3D Code Execution Vulnerability Remediation**

## **1. Tenable Vulnerability Management Scan Findings**
A **Tenable Vulnerability Management Scan** detected a **High Risk** vulnerability in **Microsoft 3D Viewer**, identified by **Plugin ID 10114**.

### **Description:**
The installed version of **Microsoft 3D Viewer** is affected by a **code execution vulnerability** in the **Base3D rendering engine**, which improperly handles memory.  
If exploited, an attacker could gain unauthorized execution on the system.

### **Key Details:**
- **Vulnerability Priority Rating (VPR):** **5.9**
- **Affected Asset(s):** **1**
- **Exploitability:** **No known public exploits**
- **CVEs:** [CVE-2020-17003](https://www.zerodayinitiative.com/advisories/ZDI-20-1246/), [CVE-2020-16918](https://www.zerodayinitiative.com/advisories/ZDI-20-1246/)

---

## **2. Remediation Steps**
Since **no patch is available for Windows 10**, the only viable remediation is **complete removal** of Microsoft 3D Viewer.

### **PowerShell Script for Automatic Detection and Removal**
To automate the vulnerability remediation, the following **PowerShell script** detects, verifies, and removes **Microsoft 3D Viewer**.

## **3. Screenshots of the Remediation Process

### A.) Initial Detection of Microsoft 3D Viewer Vulnerability via tenable
![Capture 1](screenshots/Microsoft3DViewer_Remediation/MS-3D-Viewer01.png)

### B.) Opening Powershell as Administrator
![Capture 2](screenshots/Microsoft3DViewer_Remediation/MS-3D-Viewer02.png)

### C.) Confirming installation of Microsoft3D Viewer on Virtual Machine
![Capture 3](screenshots/Microsoft3DViewer_Remediation/MS-3D-Viewer03.png)

### D.) Using winget script ot upgrade Microsoft3D Viewer and error of no installed packages matching input criteria
![Capture 4](screenshots/Microsoft3DViewer_Remediation/MS-3D-Viewer04.png)

### E.) Using scoop to install winget, geting an error, verifying winget is installed, and verifying 3D Viewer is installed via MS Store
![Capture 5](screenshots/Microsoft3DViewer_Remediation/MS-3D-Viewer05.png)

### F.)  Restarting Winget, trying to upgrade winget, Removing 3DViewer and reinstalling, checking for upgrade, and receiving same error
![Capture 6](screenshots/Microsoft3DViewer_Remediation/MS-3D-Viewer06.png)

### G.) Removing Microsoft3D Viewer as final vulnerability remediation step concluding no patch or update available
![Capture 7](screenshots/Microsoft3DViewer_Remediation/MS-3D-Viewer07.png)


```powershell
<#
.SYNOPSIS
    This PowerShell script detects, verifies, and removes Microsoft 3D Viewer due to a critical code execution vulnerability.

.DESCRIPTION
    The script checks if Microsoft 3D Viewer is installed, attempts an upgrade, and if no patched version is available, 
    removes it to mitigate the security risk.

.NOTES
    Author          : [Your Name]
    LinkedIn        : [Your LinkedIn]
    GitHub          : [Your GitHub]
    Date Created    : 2025-02-18
    Last Modified   : 2025-02-18
    Version         : 1.0
    CVEs            : CVE-2020-17003, CVE-2020-16918
    Plugin IDs      : 10114 (Nessus)
    STIG-ID         : N/A

.TESTED ON
    Date(s) Tested  : 2025-02-18
    Tested By       : [Your Name]
    Systems Tested  : Windows 10, Windows 11
    PowerShell Ver. : 5.1+

.USAGE
    Run this script in an **elevated PowerShell session** to detect and remediate the vulnerability.

    Example usage:
    PS C:\> .\Remove-Microsoft3DViewer.ps1 
#>

# Check if Microsoft 3D Viewer is installed
$3DViewer = Get-AppxPackage *Microsoft3DViewer*

if ($3DViewer) {
    Write-Host "Microsoft 3D Viewer is installed. Checking for updates..." -ForegroundColor Yellow

    # Try to update using winget
    $wingetCheck = winget search Microsoft.Microsoft3DViewer

    if ($wingetCheck -match "No package found matching input criteria") {
        Write-Host "No updated version available. Proceeding with removal..." -ForegroundColor Red
        
        # Remove Microsoft 3D Viewer
        Get-AppxPackage *Microsoft3DViewer* | Remove-AppxPackage

        # Verify removal
        $verifyRemoval = Get-AppxPackage *Microsoft3DViewer*
        if (-not $verifyRemoval) {
            Write-Host "Microsoft 3D Viewer successfully removed." -ForegroundColor Green
        } else {
            Write-Host "Error: Microsoft 3D Viewer is still installed. Manual removal may be required." -ForegroundColor Red
        }
    } else {
        Write-Host "A newer version may be available. Please update manually via Microsoft Store." -ForegroundColor Cyan
    }
} else {
    Write-Host "Microsoft 3D Viewer is not installed. No action required." -ForegroundColor Green
}





